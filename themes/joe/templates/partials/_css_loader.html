<!-- Styles -->
{%- assets filters="pyscss,cssmin",
    depends=('**/*.scss'), output="non_critical.min.css",
    "non_critical.scss" %}
<script id="loadcss">
/*!
loadCSS: load a CSS file asynchronously.
[c]2014 @scottjehl, Filament Group, Inc.
Licensed MIT
*/
/* exported loadCSS */
function loadCSS( href, before, media, callback ){
    "use strict";
    var ss = window.document.createElement( "link" );
    var ref = before || window.document.getElementsByTagName( "script" )[ 0 ];
    var sheets = window.document.styleSheets;
    ss.rel = "stylesheet";
    ss.href = href;
    // temporarily, set media to something non-matching to ensure it'll fetch without blocking render
    ss.media = "only x";
    // DEPRECATED
    if( callback ) {
        ss.onload = callback;
    }

    // inject link
    ref.parentNode.insertBefore( ss, ref );
    // This function sets the link's media back to `all` so that the stylesheet applies once it loads
    // It is designed to poll until document.styleSheets includes the new sheet.
    ss.onloadcssdefined = function( cb ){
        var defined;
        for( var i = 0; i < sheets.length; i++ ){
            if( sheets[ i ].href && sheets[ i ].href === ss.href ){
                defined = true;
            }
        }
        if( defined ){
            cb();
        } else {
            setTimeout(function() {
                ss.onloadcssdefined( cb );
            });
        }
    };
    ss.onloadcssdefined(function() {
        ss.media = media || "all";
    });
    return ss;
}
loadCSS( "{{ SITEURL | replace('https://', '//') }}/{{ ASSET_URL }}", document.getElementById("loadcss") );
</script>
<noscript>
    <link href="{{ SITEURL | replace('https://', '//') }}/{{ ASSET_URL }}" rel="stylesheet">
</noscript>
{%- endassets %}